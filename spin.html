<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>MRI Spin</title>

  <script type="text/javascript" charset="utf-8" src="components/MathBox/vendor/domready.js"></script>
  <script type="text/javascript" charset="utf-8" src="components/MathBox/build/MathBox-bundle.js"></script>

  <script type="text/javascript" charset="utf-8">
    DomReady.ready(function () {
      if (location.href.match(/^file:/)) {
        document.getElementById('info').style.opacity = 1;
        document.getElementById('info').innerHTML = "Sorry. This example does not work when accessed using file://. Please use an http:// host and try again.";
      }
    });
  </script>

  <script type="text/javascript" charset="utf-8">

// parameters
var t1 = 200;
var t2 = 100;
var w = 2*Math.PI / t2;

// 3D relaxation curve
var relaxation = function (t) { 
  //x(t) = exp(-t/t2).cos(w.t)
  //y(t) = exp(-t/t2).sin(w.t)
  //z(t) = 1 - exp(-t/t1)
  
  return [ 
    -1 * Math.exp(-t / t2) * Math.sin( w * t), 
    Math.exp(-t / t2) * Math.cos( w * t),
    1 - Math.exp(-t / t1)
    ]
};

// 2D curves 
// * exp(-t/t2)
// * 1-exp(-t/t1)

  /**
   * Bootstrap
   */
  DomReady.ready(function() {
    ThreeBox.preload([
      'components/MathBox/build/MathBox.glsl.html',
    ], function () {

      // MathBox boilerplate
      var mathbox = window.mathbox = mathBox({
        cameraControls: true,
        cursor:         true,
        controlClass:   ThreeBox.OrbitControls,
        elementResize:  true,
        fullscreen:     true,
        screenshot:     true,
        stats:          false,
        scale:          1,
      }).start();

      // Viewport camera/setup
      mathbox
        // Cartesian viewport
        .viewport({
          type: 'cartesian',
          range: [[-1, 1], [-1, 1], [0, 1]],
          scale: [1, 1, 0.7],
          rotation: [-π / 2, 0, -π / 2], 
        })
        .camera({
          id:'cam',
          orbit: 5,
          phi: 1.5 * π / 4,
          theta: 0.7 * π / 6,
        })
        .transition(300)

        // Axes
        .axis({
          id: 'x',
          axis: 0,
          color: 0xa0a0a0,
          ticks: 0,
          lineWidth: 2,
          size: .05,
          labels: false,
        })
        .axis({
          id: 'y',
          axis: 1,
          color: 0xa0a0a0,
          ticks: 0,
          lineWidth: 2,
          size: .05,
          zero: false,
          labels: false,
        })
        .axis({
          id: 'z',
          axis: 2,
          color: 0xa0a0a0,
          ticks: 0,
          lineWidth: 2,
          size: 0.05,
          zero: false,
          labels: false,
        })
        .curve({
          id: 'relaxation',
          n: 2000,
          domain: [0, 1000],
          expression: relaxation,
          color: 0xfa6705,
          line: true,
          points: false,
          lineWidth: 3,
        })

    });
  });
  </script>

  <style type="text/css" media="screen">
    html, body { height: 100%; }
    body { margin: 0; padding: 0 }
    canvas { display: block }

    #info {
      position: absolute;
      left: 50%;
      bottom: 50px;
      z-index: 20;

      width: 300px;
      margin-left: -150px;

      padding: 25px;
      background: rgba(0, 0, 0, .5);
      color: #fff;

      font-family: "Lucida Grande", sans-serif;
      font-size: 16px;
      text-align: center;

      border-radius: 3px;
      text-shadow: 0px 1px 0px rgba(0, 0, 0, .4);

      opacity: 0;
    }

    #info kbd {
      background: #aaa;

      box-shadow: 0px 1px 1px rgba(0, 0, 0, .3);
      border-radius: 3px;
      padding: 3px;
      margin: 3px;

      font-family: inherit;
    }

    #original {
      position: absolute;
      z-index: 10;
    }

  </style>

</head>
<body>
  <img id="original" src="relaxation.svg" width="800"/>
  <div id="info"></div>
</body>
</html>
